# 信号处理

!!! abstract "摘要"

    无论是采用侵入式还是非侵入式技术记录到的大脑信号，一般都会含有多种噪声或者来自多个神经元的混合信号，本章介绍了从原始信号中提取有用信号的常用方法。

    - 对于侵入式技术，锋电位分类将单个神经元产生的锋电位从混合信号中提取出来；
    - 对于非侵入式技术，有多种特征提取技术可用，这些基于频域、时域或小波分析的技术可与空间滤波技术相结合，以实现降维（PCA）、从混合信号中分离出源信号（ICA）或增加输出的不同类别信号的可区分度（CSP）；
    - 其中部分技术还能用于去除源于大脑外部的伪迹；

    总而言之，没有一种最佳技术普适于所有BCI应用，需要根据特定的BCI范式和任务类型来选择。

??? note "锋电位分类"

    用于BCI的侵入式技术通常依赖于由微电极阵列记录到的锋电位，这些信号通常是电极附近数个神经元所产生的神经混合信号。传统的BCI输入信号形式期望是来自单个神经元的锋电位，所以需要通过锋电位分类将单个神经元产生的锋电位从混合信号中提取出来。

    锋电位分类具有一下几种常用方法：
    - 依据幅值幅度的分类
    - 窗型鉴别器（人工）
    - 自动归类（最新的趋势），依据锋电位波形的特征（特征提取方法：小波分析、主成分分析等）

## 频域分析

!!! info ""

    诸如EEG的非侵入式技术基于能反映数千个神经元活动的信号，这些信号能捕捉[具有特定频率范围的“脑电波”](../Ch3/#_9)，因此对信号进行频域分析特别有用。

### 傅里叶分析

傅里叶分析的基本思想是将一个信号分解为不同频率的正弦和余弦波的加权和，权值（幅值） $a_n$ 和 $b_n$ 能由输入信号计算得到。信号分解使我们可以进行基于频率的多种类型的滤波处理。

??? quote "时域信号 $G(t)$ 的傅里叶级数展开"

    $$
    G(t) = \frac{a_0}{2} + \sum_{n=1}^\infty a_0 cos(2\pi nft) + \sum_{n=1}^\infty b_0 sin(2\pi nft)
    $$

    $$
    a_n = \frac{2}{T} \int_{-T/2}^{T/2} {G(t) cos(2\pi nft) dt}
    $$

    $$
    b_n = \frac{2}{T} \int_{-T/2}^{T/2} {G(t) sin(2\pi nft) dt}
    $$

    $$
    \frac{a_0}{2} = \frac{1}{T} \int_{-T/2}^{T/2} {G(t) dt}
    $$

??? quote "复数形式的傅里叶变换及反变换"

    $$
    c_n = 
    \begin{cases}
    \frac{a_n - j b_n}{2} & n > 0 \\[2ex]
    \frac{a_0}{2} & n = 0 \\[2ex]
    \frac{a_n + j b_n}{2} & n < 0
    \end{cases}
    $$

    $$
    c_n = \frac{1}{T} \int_{-T/2}^{T/2} {G(t) e^{-jn\omega t} dt}
    $$

    $$
    G(t) = \sum_{n = -\infty}^{+\infty} c_n e^{-jn\omega t}
    $$



## 时域分析

## 空间滤波

## 伪迹去除技术